{% extends "base.html" %}
{% load static %}
{% block title %}
  {{ media_title }} S{{ season.season_number }} - Yamtrack
{% endblock title %}
{% block content %}
  <div class="container">
    <div class="details-top d-flex">
      <div class="image">
        <img src="{{ season.image }}"
             class="{% if season.image != IMG_NONE %} poster {% else %} image-not-found {% endif %}"
             alt="{{ season.name }}"/>
      </div>
      <div class="details-data d-flex flex-column align-items-start">
        <div class="tv-title">
          <a href="{% url 'media_details' media_type="tv" media_id=media_id title=media_title|slugify %}">
            {{ media_title|capfirst }}
          </a>
        </div>
        <div class="title fs-4">{{ season.name }}</div>
        <div class="start-date">
          <strong>Release date:</strong>
          {{ season.start_date }}
        </div>
        <div class="synopsis">
          <strong>Synopsis:</strong>
          {{ season.synopsis }}
        </div>
        <div class="episodes-num">
          <strong>Total Episodes: {{ season.episodes|length }}</strong>
        </div>
        <div class="buttons-group">
          {% include "app/components/open_track_form.html" with media_type="season" media_id=media_id season_number=season.season_number title=media_title|capfirst only %}
          {% comment %} check for not None because Season 0 evaluates to false {% endcomment %}
          {% if previous_season != None %}
            <a href="{% url 'season_details' media_id=media_id title=media_title|slugify season_number=previous_season %}"
               title="Previous Season"
               class="btn btn-secondary ms-1">
              <i class="bi bi-chevron-double-left"></i>
            </a>
          {% else %}
            <a class="btn btn-secondary disabled ms-1">
              <i class="bi bi-chevron-double-left"></i>
            </a>
          {% endif %}
          {% if next_season != None %}
            <a href="{% url 'season_details' media_id=media_id title=media_title|slugify season_number=next_season %}"
               title="Next Season"
               class="btn btn-secondary ms-1">
              <i class="bi bi-chevron-double-right"></i>
            </a>
          {% else %}
            <a class="btn btn-secondary disabled ms-1">
              <i class="bi bi-chevron-double-right"></i>
            </a>
          {% endif %}
        </div>
      </div>
    </div>
    <form class="mt-4" method="post">
      {% csrf_token %}
      <input type="hidden" name="media_id" value="{{ media_id }}">
      <input type="hidden" name="season_number" value="{{ season.season_number }}">
      <div class="d-flex justify-content-between align-items-center episode">
        <div class="p-2 check-div">
          <input type="checkbox" class="form-check-input select-all">
        </div>
    {% for episode in season.episodes %}
      <div class="card mb-3">
        <div class="row g-0">
          {% if episode.still_path is None %}
            <div class="col-sm-3 episode-img-none"></div>
          {% else %} 
            <div class="col-sm-3">
              <img src="{% if episode.still_path is None %}
                          https://www.themoviedb.org/assets/2/v4/glyphicons/basic/glyphicons-basic-38-picture-grey-c2ebdbb057f2a7614185931650f8cee23fa137b93812ccb132b9df511df1cfac.svg 
                        {% else %} 
                          https://image.tmdb.org/t/p/w500{{ episode.still_path }}
                        {% endif %}"
                  class="episode-img rounded-start" alt="E{{ episode.episode_number }} image">
        </div>
          {% endif %}
          
          <div class="col-sm-9">
            <div class="card-body">
              <div class="episode-name">
                S{{ season.season_number|stringformat:"02d" }}.E{{ episode.episode_number|stringformat:"02d" }} - {{ episode.name }}
        </div>
              <div class="mb-2"><small class="text-body-secondary">{{ episode.air_date|default:"Unknown Release Date" }}</small></div>
              <div class="episode-overview">{{ episode.overview }}</div>
              <div>
                <i class="bi bi-check-circle"></i>
        </div>
      </div>

          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% endblock content %}
